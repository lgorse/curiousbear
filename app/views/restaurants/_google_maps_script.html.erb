<script>
var map;
var service;
var infowindow;
var lat =  <%= @lat.to_f %>
var lng = <%= @lng.to_f %>


function initialize() {
  var center = new google.maps.LatLng(lat, lng);
  map = new google.maps.Map(document.getElementById('map'), {
      mapTypeId: google.maps.MapTypeId.ROADMAP,
      center: center,
      zoom: 16
    });
var request = {
    location: center,
    radius: '1000',
    types: <%= raw GOOGLE_TYPES %>
  };

  service = new google.maps.places.PlacesService(map);
  service.nearbySearch(request, callback);
}

function callback(results, status) {
  if (status == google.maps.places.PlacesServiceStatus.OK) {
    for (var i = 0; i < results.length; i++) {
      var place = results[i];

      var marker = new google.maps.Marker({
        map: map,
        position: place.geometry.location,
        title: place.name
      });
      marker.setMap(map);
    }
  }
}



</script>